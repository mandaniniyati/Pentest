import subprocess
import re
import sys


def nikto():
    remoteServer = input("Enter target ip address  to scan: ")
    check = re.findall(r"\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b", remoteServer)
    if check:
        f = "http://" + remoteServer + "/"
        p1 = subprocess.Popen(['nikto', '-Plugins', 'cgi', '-host', f, '-output', 'cginikto.txt'], stdout=sys.stdout, stderr=sys.stderr)
        print("Scanning " + f + " with CGI Scan please be patient...")
        output1 = p1.communicate()[0]
        print(output1)
        p2 = subprocess.Popen(['nikto', '-Plugins', 'ssl', '-host', f, '-output', 'sslnikto.txt'], stdout=sys.stdout, stderr=sys.stderr)
        print("Scanning " + f + " with SSL Scan please be patient...")
        output2 = p2.communicate()[0]
        print(output2)
        p3 = subprocess.Popen(['nikto', '-Plugins', 'sitefiles', '-', '-host', f, '-output', 'sitefilesnikto.txt'], stdout=sys.stdout, stderr=sys.stderr)
        print("Scanning " + f + " with Sitefiles Scan please be patient...")
        output3 = p3.communicate()[0]
        print(output3)
        g = "nikto.txt"
        pattern = "0 host(s) tested"
        #with open(g, 'r') as file:
            #for pattern in file.read():
                #f1 = "http://" + remoteServer
                #p1 = subprocess.Popen(['nikto', '-h', f1, '-output', 'nikto.txt'], stdout=sys.stdout, stderr=sys.stderr)
                #print("Scanning " + f1 + " with Nikto Intense Scan...")
                #print("------------**RESULTS**----------------------------")
                #output = p1.communicate()[0]
                #print(output)
    else:
        p1 = subprocess.Popen(['nikto', '-Plugins', 'outdated', '-host', remoteServer, '-output', 'sslnikto.txt'],
                              stdout=sys.stdout, stderr=sys.stderr)
        print("Scanning " + remoteServer + " with SSL Scan please be patient...")
        output = p1.communicate()[0]
        print(output)
        #g = "nikto.txt"
        #pattern = "0 host(s) tested"
        #with open(g, 'r') as file:
         #   for pattern in file.read():
          #      p1 = subprocess.Popen(['nikto', '-h', remoteServer, '-output', 'nikto.txt'], stdout=sys.stdout,stderr=sys.stderr)
                #print("Scanning " + remoteServer + " with Nikto Intense Scan...")
                #print("------------**RESULTS**----------------------------")
                #output = p1.communicate()[0]
                #print(output)
