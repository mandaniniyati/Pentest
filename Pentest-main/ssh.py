import socket
import main
import os
import subprocess
import sys

def ssh():
    remotesrver = input("Enter remote host(s) to scan: ")
    ip_addr = remotesrver
    port = 22
    try:
        path = "ssh-audit"
        sock = socket.socket()
        sock.connect((ip_addr, port))
        out, err = main.git_clone('https://github.com/arthepsy/ssh-audit.git')
        os.chdir(path)
        p1 = subprocess.Popen(['python3', 'ssh-audit.py', remotesrver], stdout=sys.stdout, stderr=sys.stderr)
        output = p1.communicate()[0]
        print("------------**RESULTS**----------------------------")
        print(output)
    except Exception:
        print("Port 22 is closed on host " + remotesrver + ". ssh_audit could not be performed")
    pass